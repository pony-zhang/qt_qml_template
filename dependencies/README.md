# Third-Party Dependencies

è¿™ä¸ªç›®å½•ç”¨äºç®¡ç†é¡¹ç›®çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæ”¯æŒå°†å®Œæ•´çš„ç¬¬ä¸‰æ–¹é¡¹ç›®ç›´æ¥æ”¾åœ¨æ­¤ç›®å½•ä¸­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶æ„å»ºã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
dependencies/
â”œâ”€â”€ CMakeLists.txt              # ä¸»æ„å»ºæ–‡ä»¶
â”œâ”€â”€ ThirdPartyConfig.cmake.in   # é…ç½®æ¨¡æ¿
â”œâ”€â”€ include/                    # ç»Ÿä¸€å¤´æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ lib/                        # ç»Ÿä¸€åº“æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ bin/                        # ç»Ÿä¸€äºŒè¿›åˆ¶æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ project-1/                  # ç¬¬ä¸€ä¸ªç¬¬ä¸‰æ–¹é¡¹ç›®
â”‚   â”œâ”€â”€ CMakeLists.txt          # æˆ– .pro æ–‡ä»¶
â”‚   â”œâ”€â”€ include/
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ project-2/                  # ç¬¬äºŒä¸ªç¬¬ä¸‰æ–¹é¡¹ç›®
â”‚   â”œâ”€â”€ project-2.pro           # QMake é¡¹ç›®æ–‡ä»¶
â”‚   â”œâ”€â”€ headers/
â”‚   â”œâ”€â”€ sources/
â”‚   â””â”€â”€ ...
â””â”€â”€ README.md                   # æœ¬æ–‡ä»¶
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. æ·»åŠ ç¬¬ä¸‰æ–¹é¡¹ç›®

å°†æ•´ä¸ªç¬¬ä¸‰æ–¹é¡¹ç›®ç›®å½•å¤åˆ¶åˆ° `dependencies/` ç›®å½•ä¸‹ï¼š

```bash
# ä¾‹å¦‚æ·»åŠ ä¸€ä¸ª CMake é¡¹ç›®
dependencies/my-cmake-lib/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ include/mylib.h
â”œâ”€â”€ src/mylib.cpp
â””â”€â”€ ...

# æˆ–è€…æ·»åŠ ä¸€ä¸ª QMake é¡¹ç›®
dependencies/my-qmake-lib/
â”œâ”€â”€ my-qmake-lib.pro
â”œâ”€â”€ headers/mylib.h
â”œâ”€â”€ sources/mylib.cpp
â””â”€â”€ ...
```

### 2. è‡ªåŠ¨å‘ç°å’Œæ„å»º

ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰«æ `dependencies/` ç›®å½•ï¼Œå‘ç°å…·æœ‰ `CMakeLists.txt` æˆ– `.pro` æ–‡ä»¶çš„é¡¹ç›®ï¼š

- **CMake é¡¹ç›®**: è‡ªåŠ¨é…ç½®å¹¶æ„å»ºï¼Œå®‰è£…åˆ°ç‹¬ç«‹ç›®å½•
- **QMake é¡¹ç›®**: è‡ªåŠ¨ä½¿ç”¨ qmake æ„å»ºï¼Œå¤åˆ¶åº“æ–‡ä»¶å’Œå¤´æ–‡ä»¶
- **é¢„ç¼–è¯‘åº“**: å¯ä»¥æ‰‹åŠ¨æ·»åŠ å·²ç¼–è¯‘å¥½çš„åº“æ–‡ä»¶

### 3. åœ¨ä¸»é¡¹ç›®ä¸­ä½¿ç”¨

åœ¨ä¸»é¡¹ç›®çš„ CMakeLists.txt ä¸­ï¼š

```cmake
# æ·»åŠ ä¾èµ–å­ç›®å½•
add_subdirectory(dependencies)

# é“¾æ¥æ‰€æœ‰ç¬¬ä¸‰æ–¹åº“
target_link_libraries(${PROJECT_NAME} PRIVATE
    third_party
)

# åŒ…å«å¤´æ–‡ä»¶ç›®å½•
target_include_directories(${PROJECT_NAME} PRIVATE
    ${THIRD_PARTY_INCLUDE_DIRS}
)
```

### 4. æ‰‹åŠ¨æ·»åŠ ç‰¹å®šé¡¹ç›®

å¦‚æœéœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ ï¼š

```cmake
# æ·»åŠ  CMake é¡¹ç›®ï¼Œä¼ é€’é¢å¤–å‚æ•°
add_third_party(myproject
    BUILD_TYPE Debug
    CMAKE_ARGS -DENABLE_FEATURES=ON -DBUILD_EXAMPLES=OFF
)

# æ·»åŠ é¢„ç¼–è¯‘åº“
add_prebuilt_third_party(mylib
    LIBRARY_PATH prebuilt/libmylib.a
    INCLUDE_DIR prebuilt/include
)
```

## ğŸ› ï¸ æ„å»ºç›®æ ‡

### `deps-clean`
æ¸…ç†æ‰€æœ‰ç¼–è¯‘çš„ä¾èµ–æ–‡ä»¶ï¼š
```bash
cmake --build . --target deps-clean
```

### `deps-status`
æ˜¾ç¤ºä¾èµ–çŠ¶æ€å’Œå¯ç”¨åº“ï¼š
```bash
cmake --build . --target deps-status
```

### `deps-rebuild`
é‡æ–°æ„å»ºæ‰€æœ‰ä¾èµ–ï¼š
```bash
cmake --build . --target deps-rebuild
```

### `project-name_build`
æ„å»ºç‰¹å®šé¡¹ç›®ï¼š
```bash
cmake --build . --target myproject_build
```

## ğŸ“¦ æ”¯æŒçš„é¡¹ç›®ç±»å‹

### CMake é¡¹ç›®
- è‡ªåŠ¨æ£€æµ‹ `CMakeLists.txt`
- æ”¯æŒä¼ é€’ CMake å‚æ•°
- è‡ªåŠ¨å®‰è£…åˆ°ç‹¬ç«‹ç›®å½•
- è‡ªåŠ¨å‘ç°ç”Ÿæˆçš„åº“æ–‡ä»¶

### QMake é¡¹ç›®
- è‡ªåŠ¨æ£€æµ‹ `.pro` æ–‡ä»¶
- è‡ªåŠ¨é…ç½®ä¸ºé™æ€åº“æ„å»º
- å¤åˆ¶ç”Ÿæˆçš„åº“æ–‡ä»¶åˆ°ç»Ÿä¸€ç›®å½•
- è‡ªåŠ¨å¤åˆ¶å¤´æ–‡ä»¶

### é¢„ç¼–è¯‘åº“
- æ”¯æŒé™æ€åº“æ–‡ä»¶
- æ”¯æŒå¤´æ–‡ä»¶ç›®å½•
- è‡ªåŠ¨åˆ›å»ºå¯¼å…¥ç›®æ ‡

## ğŸ”§ é…ç½®é€‰é¡¹

### CMake é¡¹ç›®å‚æ•°
```cmake
add_third_party(project_name
    BUILD_TYPE Release|Debug          # æ„å»ºç±»å‹
    INSTALL_DIR /custom/path         # å®‰è£…ç›®å½•
    CMAKE_ARGS "-DVAR=VALUE"         # ä¼ é€’ç»™ CMake çš„å‚æ•°
)
```

### é¢„ç¼–è¯‘åº“å‚æ•°
```cmake
add_prebuilt_third_party(project_name
    LIBRARY_PATH path/to/lib.a       # åº“æ–‡ä»¶è·¯å¾„
    INCLUDE_DIR path/to/include      # å¤´æ–‡ä»¶ç›®å½•
)
```

## ğŸ“‹ æœ€ä½³å®è·µ

1. **é¡¹ç›®å‘½å**: ä½¿ç”¨æœ‰æ„ä¹‰çš„é¡¹ç›®åç§°ï¼Œå»ºè®®åŒ…å«ç‰ˆæœ¬å·
2. **ç›®å½•ç»“æ„**: ä¿æŒç¬¬ä¸‰æ–¹é¡¹ç›®çš„åŸå§‹ç»“æ„
3. **ä¾èµ–ç®¡ç†**: å°½é‡ä½¿ç”¨é™æ€åº“ä»¥å‡å°‘è¿è¡Œæ—¶ä¾èµ–
4. **ç‰ˆæœ¬æ§åˆ¶**: åœ¨ç›®å½•åä¸­åŒ…å«ç‰ˆæœ¬ä¿¡æ¯ï¼ˆå¦‚ `boost-1.83.0`ï¼‰
5. **æ–‡æ¡£**: åœ¨é¡¹ç›®ä¸­æ·»åŠ  README è¯´æ˜ä½¿ç”¨æ–¹æ³•

## ğŸ› æ•…éšœæ’é™¤

### é¡¹ç›®æœªè¢«è¯†åˆ«
- æ£€æŸ¥é¡¹ç›®ç›®å½•ä¸­æ˜¯å¦æœ‰ `CMakeLists.txt` æˆ– `.pro` æ–‡ä»¶
- ç¡®ä¿ç›®å½•åä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–ç©ºæ ¼
- æ£€æŸ¥ç›®å½•æƒé™

### æ„å»ºå¤±è´¥
- æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„å…·ä½“é”™è¯¯ä¿¡æ¯
- æ£€æŸ¥æ˜¯å¦ç¼ºå°‘æ„å»ºå·¥å…·ï¼ˆå¦‚ qmakeï¼‰
- éªŒè¯ç¬¬ä¸‰æ–¹é¡¹ç›®çš„ä¾èµ–æ˜¯å¦æ»¡è¶³

### é“¾æ¥é”™è¯¯
- ç¡®ä¿åº“æ–‡ä»¶æˆåŠŸç”Ÿæˆ
- æ£€æŸ¥åº“çš„ç±»å‹ï¼ˆé™æ€/åŠ¨æ€ï¼‰æ˜¯å¦åŒ¹é…
- éªŒè¯å¤´æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®

### CMake ç‰ˆæœ¬
- éœ€è¦ CMake 3.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- æŸäº›åŠŸèƒ½å¯èƒ½éœ€è¦æ›´æ–°ç‰ˆæœ¬çš„ CMake

## ğŸ¯ é«˜çº§ç‰¹æ€§

### è‡ªåŠ¨å‘ç°
ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰«æç›®å½•ä¸­çš„æ‰€æœ‰é¡¹ç›®ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚

### ç‹¬ç«‹æ„å»º
æ¯ä¸ªç¬¬ä¸‰æ–¹é¡¹ç›®åœ¨ç‹¬ç«‹çš„æ„å»ºç›®å½•ä¸­æ„å»ºï¼Œé¿å…å†²çªã€‚

### ç»Ÿä¸€æ¥å£
æ‰€æœ‰ç¬¬ä¸‰æ–¹åº“é€šè¿‡ `third_party` ç›®æ ‡ç»Ÿä¸€é“¾æ¥ï¼Œç®€åŒ–ä½¿ç”¨ã€‚

### å¤´æ–‡ä»¶ç®¡ç†
è‡ªåŠ¨å¤åˆ¶å’Œç®¡ç†å¤´æ–‡ä»¶åˆ°ç»Ÿä¸€ç›®å½•ã€‚

## ğŸ“ ç¤ºä¾‹

```bash
# æ·»åŠ ä¸€ä¸ª CMake é¡¹ç›®
git clone https://github.com/example/library.git dependencies/my-library

# æ·»åŠ ä¸€ä¸ª QMake é¡¹ç›®
cp -r /path/to/qmake-project dependencies/my-qmake-project

# æ„å»ºé¡¹ç›®
cmake --build . --target deps-clean
cmake --build .
```

ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰ç¬¬ä¸‰æ–¹é¡¹ç›®çš„æ„å»ºå’Œé›†æˆã€‚